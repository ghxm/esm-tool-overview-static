---
layout: default
title: "Tool Overview"
---

<div class="row">
    <div class="col-12">
        <!-- Page Header -->
        <div class="mb-4">
            <h1 class="display-4">Tool Overview</h1>
            <p class="lead">A community-based collection of tools for mobile ecological momentary assessments and sensing</p>
        </div>

        <!-- Search and Filter Controls -->
        <div class="card mb-4">
            <div class="card-body">
                <div class="row g-3">
                    <div class="col-md-4">
                        <label for="search" class="form-label">Search Tools</label>
                        <input type="text" class="form-control" id="search" placeholder="Search by name, description, or maintainer...">
                    </div>
                    
                    {% assign filterable_fields = "" | split: "," %}
                    {% for field in site.fields %}
                        {% assign field_config = field[1] %}
                        {% if field_config.filter.display == true %}
                            {% assign filterable_fields = filterable_fields | push: field %}
                        {% endif %}
                    {% endfor %}
                    {% assign filter_count = filterable_fields.size %}
                    {% if filter_count > 0 %}
                        {% assign col_size = 8 | divided_by: filter_count %}
                        {% if col_size < 2 %}{% assign col_size = 2 %}{% endif %}
                    {% else %}
                        {% assign col_size = 12 %}
                    {% endif %}
                    
                    {% for field in filterable_fields %}
                        {% assign field_name = field[0] %}
                        {% assign field_config = field[1] %}
                        {% if field_config.filter.type == "select" %}
                            <div class="col-md-{{ col_size }}">
                                <label for="{{ field_name }}-filter" class="form-label">
                                    {% if field_config.filter.label %}{{ field_config.filter.label }}{% else %}{{ field_config.label }}{% endif %}
                                    {% if field_config.tooltip %}
                                        <i class="fas fa-question-circle text-muted ms-1" 
                                           data-bs-toggle="tooltip" 
                                           data-bs-placement="top" 
                                           data-bs-trigger="hover focus"
                                           title="{{ field_config.tooltip }}"></i>
                                    {% elsif field_config.popover %}
                                        <i class="fas fa-question-circle text-muted ms-1" 
                                           data-bs-toggle="popover" 
                                           data-bs-placement="top" 
                                           data-bs-trigger="click"
                                           data-bs-title="{{ field_config.popover.title }}"
                                           data-bs-content="{{ field_config.popover.content }}"></i>
                                    {% endif %}
                                </label>
                                <select class="form-select filter-select" id="{{ field_name }}-filter" data-field="{{ field_name }}" data-type="select">
                                    <option value="">All {% if field_config.filter.label %}{{ field_config.filter.label }}{% else %}{{ field_config.label }}{% endif %}</option>
                                    {% assign field_values = "" | split: "," %}
                                    {% for tool in site.tools %}
                                        {% assign field_parts = field_name | split: "." %}
                                        {% assign tool_field_value = tool %}
                                        {% for part in field_parts %}
                                            {% assign tool_field_value = tool_field_value[part] %}
                                        {% endfor %}
                                        {% unless tool_field_value == nil or tool_field_value == "" %}
                                            {% assign field_values = field_values | push: tool_field_value %}
                                        {% endunless %}
                                    {% endfor %}
                                    {% assign field_values = field_values | uniq | sort %}
                                    {% for value in field_values %}
                                        {% unless value == nil or value == false or value == "" %}
                                            {% include apply_value_label.html value=value field_config=field_config %}
                                            <option value="{{ value }}">{{ display_value }}</option>
                                        {% endunless %}
                                    {% endfor %}
                                </select>
                            </div>
                        {% elsif field_config.filter.type == "multiselect-and" or field_config.filter.type == "multiselect-or" %}
                            <div class="col-md-{{ col_size }}">
                                <label class="form-label">
                                    {% if field_config.filter.label %}{{ field_config.filter.label }}{% else %}{{ field_config.label }}{% endif %}
                                    {% if field_config.tooltip %}
                                        <i class="fas fa-question-circle text-muted ms-1" 
                                           data-bs-toggle="tooltip" 
                                           data-bs-placement="top" 
                                           data-bs-trigger="hover focus"
                                           title="{{ field_config.tooltip }}"></i>
                                    {% elsif field_config.popover %}
                                        <i class="fas fa-question-circle text-muted ms-1" 
                                           data-bs-toggle="popover" 
                                           data-bs-placement="top" 
                                           data-bs-trigger="click"
                                           data-bs-title="{{ field_config.popover.title }}"
                                           data-bs-content="{{ field_config.popover.content }}"></i>
                                    {% endif %}
                                </label>
                                <div class="dropdown">
                                    <button class="btn btn-outline-secondary dropdown-toggle w-100 text-start" type="button" id="{{ field_name }}-dropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                        <span class="filter-text">All {% if field_config.filter.label %}{{ field_config.filter.label }}{% else %}{{ field_config.label }}{% endif %}</span>
                                    </button>
                                    <ul class="dropdown-menu w-100" aria-labelledby="{{ field_name }}-dropdown">
                                        <li>
                                            <button class="dropdown-item clear-multiselect" type="button" data-field="{{ field_name }}">
                                                <strong>Clear All</strong>
                                            </button>
                                        </li>
                                        <li><hr class="dropdown-divider"></li>
                                        {% assign all_values = "" | split: "," %}
                                        {% for tool in site.tools %}
                                            {% assign page = tool %}
                                            {% include get_field_value.html field_name=field_name %}
                                            {% if field_value %}
                                                {% assign field_value_type = field_value | type %}
                                                {% if field_value_type == "Array" %}
                                                    {% assign all_values = all_values | concat: field_value %}
                                                {% else %}
                                                    {% assign all_values = all_values | push: field_value %}
                                                {% endif %}
                                            {% endif %}
                                        {% endfor %}
                                        {% assign unique_values = all_values | uniq | sort %}
                                        {% for value in unique_values %}
                                            {% if value and value != "" %}
                                                {% include apply_value_label.html value=value field_config=field_config %}
                                                <li>
                                                    <label class="dropdown-item" for="{{ field_name }}-{{ forloop.index }}">
                                                        <input type="checkbox" class="form-check-input me-2 multiselect-checkbox" 
                                                               id="{{ field_name }}-{{ forloop.index }}" 
                                                               data-field="{{ field_name }}" 
                                                               data-value="{{ value }}"
                                                               data-type="{{ field_config.filter.type }}">
                                                        {{ display_value }}
                                                    </label>
                                                </li>
                                            {% endif %}
                                        {% endfor %}
                                    </ul>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <button type="button" class="btn btn-outline-secondary btn-sm" id="clear-filters">
                            Clear Filters
                        </button>
                        <span class="text-muted ms-3">
                            Showing <span id="tool-count">0</span> tools
                        </span>
                    </div>
                    <div class="col-md-6 text-md-end mt-2 mt-md-0">
                        <span class="text-muted small">Export: </span>
                        <a href="{{ '/tools.json' | relative_url }}" class="btn btn-outline-primary btn-sm" title="Download as JSON">
                            <i class="fas fa-download"></i> JSON
                        </a>
                        <a href="{{ '/tools.csv' | relative_url }}" class="btn btn-outline-primary btn-sm ms-1" title="Download as CSV">
                            <i class="fas fa-download"></i> CSV
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tools Table -->
        <div class="card" id="tools-table">
            <div class="card-body">
                <div class="table-responsive">
                    <table class="table table-hover">
                        <thead class="table-light">
                            <tr>
                                {% for field in site.fields %}
                                    {% assign field_name = field[0] %}
                                    {% assign field_config = field[1] %}
                                    {% if field_config.display contains "table" %}
                                    <th {% if field_config.sortable %}class="sort" data-sort="{{ field_name }}"{% endif %}>
                                        {{ field_config.label }}
                                    </th>
                                    {% endif %}
                                {% endfor %}
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody class="list">
                            {% for tool in site.tools %}
                                <tr class="tool-row" data-tool-url="{{ tool.url | relative_url }}">
                                    {% for field in site.fields %}
                                        {% assign field_name = field[0] %}
                                        {% assign field_config = field[1] %}
                                        {% if field_config.display contains "table" %}
                                        {% assign page = tool %}
                                        {% include get_field_value.html field_name=field_name %}
                                        {% assign value = field_value %}
                                        <td class="{{ field_name | replace: '.', '-' }}" data-raw-value="{% if value %}{% if value.first %}{{ value | join: ',' }}{% else %}{{ value }}{% endif %}{% endif %}">
                                            {% if value and value.first %}
                                                {% assign display_style = field_config.display_style | default: "string" %}
                                                {% if display_style == 'string' or display_style == 'list' %}
                                                    {% comment %} Display as comma-separated string (same for table) {% endcomment %}
                                                    {% assign display_items = '' %}
                                                    {% for item in value %}
                                                        {% include apply_value_label.html value=item field_config=field_config %}
                                                        {% if forloop.first %}
                                                            {% assign display_items = display_value %}
                                                        {% else %}
                                                            {% assign display_items = display_items | append: ', ' | append: display_value %}
                                                        {% endif %}
                                                    {% endfor %}
                                                    {{ display_items }}
                                                {% else %}
                                                    {% comment %} Display as badges (default) {% endcomment %}
                                                    {% for item in value %}
                                                    {% include apply_value_label.html value=item field_config=field_config %}
                                                    {% assign display_item = display_value %}
                                                    
                                                    {% comment %} Get consistent color for this item {% endcomment %}
                                                    {% assign base_badge_color = field_config.badge_color | default: "primary" %}
                                                    {% include get_consistent_badge_color.html value=item base_color=base_badge_color %}
                                                    {% assign item_color = consistent_color %}
                                                    
                                                    <span class="badge bg-{{ item_color }} me-1">{{ display_item }}</span>
                                                    {% endfor %}
                                                {% endif %}
                                            {% elsif field_name == 'name' and value %}
                                                <strong>{{ value }}</strong>
                                            {% elsif value %}
                                                {% assign display_style = field_config.display_style | default: "string" %}
                                                {% if display_style == 'badge' %}
                                                    {% include apply_value_label.html value=value field_config=field_config %}
                                                    {% assign badge_color = field_config.badge_color | default: "primary" %}
                                                    <span class="badge bg-{{ badge_color }}">{{ display_value }}</span>
                                                {% else %}
                                                    {% include apply_value_label.html value=value field_config=field_config %}
                                                    {{ display_value }}
                                                {% endif %}
                                            {% elsif field_config.show_if_empty %}
                                                <span class="text-muted">{% if field_config.empty_value %}{{ field_config.empty_value }}{% else %}{{ site.default_empty_value }}{% endif %}</span>
                                            {% else %}
                                                <span class="text-muted">{{ site.default_empty_value }}</span>
                                            {% endif %}
                                        </td>
                                        {% endif %}
                                    {% endfor %}
                                    <td>
                                        <div class="btn-group" role="group">
                                            <a href="{{ tool.url | relative_url }}" class="btn btn-sm btn-outline-primary">
                                                View
                                            </a>
                                            {% if tool.link %}
                                                <a href="{{ tool.link }}" target="_blank" class="btn btn-sm btn-outline-secondary">
                                                    â†—
                                                </a>
                                            {% endif %}
                                        </div>
                                    </td>
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                
                <!-- No results message -->
                <div id="no-results" class="text-center py-5" style="display: none;">
                    <h5 class="text-muted">No tools found</h5>
                    <p class="text-muted">Try adjusting your search criteria or filters.</p>
                </div>
                
            </div>
        </div>
    </div>
</div>

<script>
// Initialize List.js for table functionality
document.addEventListener('DOMContentLoaded', function() {
    // Initialize the list
    var options = {
        valueNames: [
            {% for field in site.fields %}{% assign field_name = field[0] %}{% assign field_config = field[1] %}{% if field_config.display contains "table" %}'{{ field_name }}'{% unless forloop.last %},{% endunless %}{% endif %}{% endfor %}
        ],
        listClass: 'list'
    };
    
    var toolsList = new List('tools-table', options);
    
    // Update tool count
    function updateToolCount() {
        var visibleCount = 0;
        document.querySelectorAll('.tool-row').forEach(function(row) {
            if (row.style.display !== 'none') {
                visibleCount++;
            }
        });
        document.getElementById('tool-count').textContent = visibleCount;
    }
    
    // Initial count
    updateToolCount();
    
    // Update count on search/filter
    toolsList.on('updated', updateToolCount);
    
    // Connect custom search to List.js
    document.getElementById('search').addEventListener('keyup', function() {
        toolsList.search(this.value);
    });
    
    // Dynamic filter functionality
    document.querySelectorAll('.filter-select').forEach(function(filterElement) {
        filterElement.addEventListener('change', function() {
            applyFilters();
        });
    });
    
    // Multiselect checkbox functionality
    document.querySelectorAll('.multiselect-checkbox').forEach(function(checkbox) {
        checkbox.addEventListener('change', function() {
            updateMultiselectDisplay(this.dataset.field);
            applyFilters();
        });
    });
    
    // Clear multiselect functionality
    document.querySelectorAll('.clear-multiselect').forEach(function(clearBtn) {
        clearBtn.addEventListener('click', function() {
            var field = this.dataset.field;
            document.querySelectorAll(`[data-field="${field}"].multiselect-checkbox`).forEach(function(checkbox) {
                checkbox.checked = false;
            });
            updateMultiselectDisplay(field);
            applyFilters();
        });
    });
    
    // Update multiselect display text
    function updateMultiselectDisplay(field) {
        var selectedValues = [];
        document.querySelectorAll(`[data-field="${field}"].multiselect-checkbox:checked`).forEach(function(checkbox) {
            selectedValues.push(checkbox.dataset.value);
        });
        
        var button = document.querySelector(`#${field}-dropdown .filter-text`);
        if (!button) return;
        
        // Get the original "All" text by looking at the initial text or extracting from current text
        var originalText = button.getAttribute('data-original-text');
        if (!originalText) {
            // If not stored, extract from current text or reconstruct
            var currentText = button.textContent.trim();
            if (currentText.startsWith('All ')) {
                originalText = currentText;
            } else {
                // Find the clear button to get the field name from its data attribute
                var clearButton = document.querySelector(`[data-field="${field}"].clear-multiselect`);
                if (clearButton) {
                    var dropdown = clearButton.closest('.dropdown');
                    var label = dropdown.querySelector('label .form-label');
                    if (label) {
                        originalText = `All ${label.textContent.trim()}`;
                    } else {
                        // Fallback to looking at the dropdown button's original content
                        originalText = `All ${field.charAt(0).toUpperCase() + field.slice(1).replace('_', ' ')}`;
                    }
                } else {
                    originalText = `All ${field.charAt(0).toUpperCase() + field.slice(1).replace('_', ' ')}`;
                }
            }
            button.setAttribute('data-original-text', originalText);
        }
        
        var displayText;
        if (selectedValues.length === 0) {
            displayText = originalText;
        } else if (selectedValues.length === 1) {
            displayText = selectedValues[0];
        } else {
            displayText = `${selectedValues.length} selected`;
        }
        
        button.textContent = displayText;
    }
    
    // Combined filter function
    function applyFilters() {
        var activeFilters = {};
        
        // Collect single-select filters
        document.querySelectorAll('.filter-select').forEach(function(filterElement) {
            var field = filterElement.dataset.field;
            var type = filterElement.dataset.type;
            var value = filterElement.value;
            
            if (value !== '') {
                activeFilters[field] = {
                    values: [value],
                    type: type
                };
            }
        });
        
        // Collect multiselect filters
        var multiselectFields = {};
        document.querySelectorAll('.multiselect-checkbox:checked').forEach(function(checkbox) {
            var field = checkbox.dataset.field;
            var value = checkbox.dataset.value;
            var type = checkbox.dataset.type;
            
            if (!multiselectFields[field]) {
                multiselectFields[field] = {
                    values: [],
                    type: type
                };
            }
            multiselectFields[field].values.push(value);
        });
        
        // Add multiselect filters to activeFilters
        Object.keys(multiselectFields).forEach(function(field) {
            activeFilters[field] = multiselectFields[field];
        });
        
        // If no filters are active, show all items
        if (Object.keys(activeFilters).length === 0) {
            document.querySelectorAll('.tool-row').forEach(function(row) {
                row.style.display = '';
            });
            document.getElementById('no-results').style.display = 'none';
            updateToolCount();
            return;
        }
        
        var matchingCount = 0;
        
        // Manually check each row instead of using List.js filter
        document.querySelectorAll('.tool-row').forEach(function(row) {
            var allMatch = true;
            
            // Check each active filter
            Object.keys(activeFilters).forEach(function(field) {
                var filter = activeFilters[field];
                var cssClassName = field.replace(/\./g, '-');
                var cell = row.querySelector('.' + cssClassName);
                var rawValue = cell ? cell.getAttribute('data-raw-value') || '' : '';
                var itemValues = rawValue.split(',').map(v => v.trim()).filter(v => v !== '');
                var match = false;
                
                if (filter.type === 'select') {
                    // Check if the filter value exists in the comma-separated list
                    var filterValue = filter.values[0].trim();
                    if (rawValue.includes(',')) {
                        // Multiple values - check if filter value is in the list
                        match = itemValues.includes(filterValue);
                    } else {
                        // Single value - exact match
                        match = rawValue === filterValue;
                    }
                } else if (filter.type === 'multiselect-or') {
                    // OR logic: Check if ANY of the selected values exist in the item
                    match = filter.values.some(function(filterValue) {
                        return itemValues.includes(filterValue.trim());
                    });
                } else if (filter.type === 'multiselect-and') {
                    // AND logic: Check if ALL of the selected values exist in the item
                    match = filter.values.every(function(filterValue) {
                        return itemValues.includes(filterValue.trim());
                    });
                }
                
                if (!match) {
                    allMatch = false;
                }
            });
            
            // Show/hide row based on match
            if (allMatch) {
                row.style.display = '';
                matchingCount++;
            } else {
                row.style.display = 'none';
            }
        });
        
        // Show/hide no results message and update count
        if (matchingCount === 0) {
            document.getElementById('no-results').style.display = 'block';
        } else {
            document.getElementById('no-results').style.display = 'none';
        }
        
        document.getElementById('tool-count').textContent = matchingCount;
    }
    
    // Page length functionality removed since page-length element doesn't exist
    
    // Clear filters
    document.getElementById('clear-filters').addEventListener('click', function() {
        document.getElementById('search').value = '';
        
        // Clear all single-select filters
        document.querySelectorAll('.filter-select').forEach(function(filterElement) {
            filterElement.value = '';
        });
        
        // Clear all multiselect checkboxes
        document.querySelectorAll('.multiselect-checkbox').forEach(function(checkbox) {
            checkbox.checked = false;
        });
        
        // Update multiselect display texts
        var fields = new Set();
        document.querySelectorAll('.multiselect-checkbox').forEach(function(checkbox) {
            fields.add(checkbox.dataset.field);
        });
        fields.forEach(function(field) {
            updateMultiselectDisplay(field);
        });
        
        // Reset row visibility and hide no-results message
        document.querySelectorAll('.tool-row').forEach(function(row) {
            row.style.display = '';
        });
        document.getElementById('no-results').style.display = 'none';
        
        toolsList.search('');
        toolsList.filter();
        updateToolCount();
    });
    
    // Row click functionality using event delegation
    document.getElementById('tools-table').addEventListener('click', function(e) {
        var row = e.target.closest('.tool-row');
        if (row && e.target.tagName.toLowerCase() !== 'a' && !e.target.closest('a')) {
            var toolUrl = row.dataset.toolUrl;
            if (toolUrl) {
                window.location.href = toolUrl;
            }
        }
    });
    
    // Add hover effect to all rows
    document.querySelectorAll('.tool-row').forEach(function(row) {
        row.style.cursor = 'pointer';
    });
    
    // Close other popovers when a new one is opened
    const popoverElements = document.querySelectorAll('[data-bs-toggle="popover"]');
    
    popoverElements.forEach(function(element) {
        element.addEventListener('click', function() {
            // Hide all other popovers
            popoverElements.forEach(function(otherElement) {
                if (otherElement !== element) {
                    const popover = bootstrap.Popover.getInstance(otherElement);
                    if (popover) {
                        popover.hide();
                    }
                }
            });
        });
    });
    
});
</script>