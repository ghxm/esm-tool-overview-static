<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% if page.title %}{{ page.title }} - {% endif %}{{ site.title }}</title>
    <meta name="description" content="{% if page.description %}{{ page.description }}{% else %}{{ site.description }}{% endif %}">
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">
</head>
<body class="d-flex flex-column min-vh-100">
    <!-- Navigation -->


    <!-- Main Content -->
    <main class="container my-4 flex-grow-1">
        {{ content }}
    </main>

    <!-- Footer -->
    <footer class="bg-light py-4 mt-auto">
        <div class="container">
            <div class="row">
                <div class="col-md-6">
                    <p class="mb-0">{{ 'now' | date: '%Y' }} {{ site.title }}.</p>
                </div>
                <div class="col-md-6 text-md-end">
                    <p class="mb-0">{{ site.description }}</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    
    <!-- List.js for table functionality -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/list.js/2.3.1/list.min.js"></script>
    
    <!-- Custom JS -->
    <script src="{{ '/assets/js/table.js' | relative_url }}"></script>
    
    <!-- Initialize Bootstrap tooltips and popovers -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Check for conflicting tooltip/popover configurations
            {% for field in site.fields %}
                {% assign field_name = field[0] %}
                {% assign field_config = field[1] %}
                {% if field_config.tooltip and field_config.popover %}
                    console.warn('Field "{{ field_name }}" has both tooltip and popover configured. Using popover only.');
                {% endif %}
            {% endfor %}
            
            // Initialize all tooltips
            var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
            var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
                return new bootstrap.Tooltip(tooltipTriggerEl, {
                    html: true
                });
            });
            
            // Initialize all popovers
            var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
            var popoverList = popoverTriggerList.map(function (popoverTriggerEl) {
                return new bootstrap.Popover(popoverTriggerEl, {
                    html: true,
                    trigger: 'click',
                    placement: 'auto',
                    boundary: 'viewport',
                    fallbackPlacements: ['bottom', 'left', 'right', 'top']
                });
            });
            
            // Prevent help icons from triggering parent dropdown/filter clicks
            document.querySelectorAll('[data-bs-toggle="popover"], [data-bs-toggle="tooltip"]').forEach(function(helpIcon) {
                helpIcon.addEventListener('click', function(e) {
                    e.stopPropagation();
                    e.preventDefault();
                });
            });
            
            // Close popovers when clicking outside
            document.addEventListener('click', function (e) {
                popoverList.forEach(function(popover) {
                    // If the click was not on the trigger element or inside the popover
                    if (!popover._element.contains(e.target)) {
                        popover.hide();
                    }
                });
            });
        });
    </script>
</body>
</html>